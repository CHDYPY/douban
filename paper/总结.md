# 总结一下为什么学生的评价分数与教师分数之差与偏置有关，以及他们之间比较性的关系

## Crowdgrader

该框架定义了用于同行评估的众包算法。作者声称，在进行评估时，依靠单一的评估者通常是不切实际的，并且可能被认为是不公平的。然后，该方法依靠信誉系统将学生的评估组合成一个针对每项作业的建议评估。每个学生的声誉（或他们的准确度）是通过将学生的评估与其同学对同一作业的评估进行比较来衡量的。换句话说，学生的声誉描述了他的评估与其他学生的评估相差多远。建议的评估是通过汇总所有学生评估来计算的，这些评估由提供这些评估的学生的声誉加权。

同时，本研究采用的SC-PA模型通过斯坦科尔伯格均衡向那些不可靠的学生可以观察到自己被抽查的概率，并通过学生的历史评分记录来计算学生的审核能力。

The SC-PA model proposed in this study provides an observation of the probability of being sampled by those unreliable students through Stankelberg equilibrium.

## PeerRank 



1. 根据PG模型，由于部分真实分数可知，可以直接通过极大似然估计函数确定真实分数的正态分布。

2. 由于可靠性可以直接由学生和教师之间的打分得到，于是我们可以直接得到一部分

   $\tau_v \sim N(s_v, \frac{1}{\beta_0})$ 

   $b_v \sim N(0, \frac{1}{\eta_0})$ 

   $s_u \sim N(\mu_0, \frac{1}{\gamma_0})$ 

   $z_u^v \sim N(s_u+b_v, \frac{\lambda}{\tau_v})$ 

   接下来的问题就是求解另一部分没有被抽查的学生的可靠性，这里，我们有两种思路：

   - 标签传播思路——由部分学生的可靠性进行推导，推导到其他学生的可靠性，有论文作为依据([SSPA: An effective semi-supervised peer assessment method for large scale MOOCs](https://www.tandfonline.com/doi/abs/10.1080/10494820.2019.1648299))
   - 学生在作业上的表现——还是按照之前的思路，分为两种情况进行求解

3. 现在我们的概率模型就变成了两个，不可观测偏置b和可观测变量Z

   $b_v^T \sim N(b_v^{T-1}, \frac{1}{\eta_0})$ 

   $z_u^v \sim N(s_u+b_v, \frac{\lambda}{\tau_v})$ 
   
   
   
   符号表示：
   
   | 属性                    | 符号     |
   | ----------------------- | -------- |
   | 学生                    | S        |
   | 学生提交的作业          | H        |
   | $v$给$u$评分            | $z^v_u$  |
   | $v$可靠性               | $\tau_v$ |
   | $v$偏置                 | $b_v$    |
   | u真实分数               | $t_u$    |
   | $ij$间的分数差距        | $d_{ij}$ |
   | 评分者$v$的评价过的作业 | $H_v$    |
   | 评分者$v$的评价过的人   | $S_v$    |
   |                         |          |

## 对比方法

PG6：

$\tau_v \sim \Gamma(s_v, \beta)$ 

$b_v \sim N(0, \frac{1}{\eta_0})$ 

$s_u \sim N(\alpha, \frac{1}{\gamma})$ 

$z_u^v \sim N(s_u+b_v, \frac{1}{\tau_v})$ 

$d^v_{ij} \sim N(s_i-s_j, \frac{2}{\tau_v})$ 



PG7:

$\tau_v \sim N(s_v, \beta)$ 

$b_v \sim N(0, \frac{1}{\eta_0})$ 

$s_u \sim N(\alpha, \frac{1}{\gamma})$ 

$z_u^v \sim N(s_u+b_v, \frac{\lambda}{\tau_v})$ 

$d^v_{ij} \sim N(s_i-s_j, \frac{2}{\tau_v})$ 



PG8:

$\tau_v \sim N(r_v, \beta)$  

$b_v \sim N(0, \frac{1}{\eta_0})$ 

$s_u \sim N(\alpha, \frac{1}{\gamma})$ 

$z_u^v \sim N(s_u+b_v, \frac{1}{\tau_v})$ 

$d^v_{ij} \sim N(s_i-s_j, \frac{2}{\tau_v})$ 



PG9:

$\tau_v \sim \Gamma(r_v, \beta)$  

$b_v \sim N(0, \frac{1}{\eta_0})$ 

$s_u \sim N(\alpha, \frac{1}{\gamma})$ 

$z_u^v \sim N(s_u+b_v, \frac{1}{\tau_v})$ 

$d^v_{ij} \sim N(s_i-s_j, \frac{2}{\tau_v})$ 

## 第二个点

通过抽查机制优化概率图模型。

暑假讨论的点：可观测的变量为两个，一个是Z，一个是$\tau$，通过两者的可观测性，改变PG模型的推导公式。

我们的创新点主要将PG模型中的可靠性的均值赋予了一个有效的初值，并定义了求解公式，从而完成推导，提升了PG模型的准确性。容易出问题的点就是，为啥可观测到的可靠性服从这样一个分布，无法验证我们的可靠性公式是否准确。

我们可以假设去掉$\tau$的分布，假设在公式中方差为一个常量。

### 可靠性定义

所有的评价者都有可靠性这个属性，最开始每个人的属性默认为0.5，每次互评结束之后，都会进行更新。更新的公式如下：

- 如果本次互评中学生被抽查到，那么他的可靠性更新为：

  $r_i= 1-\frac{\sum_{j\in H_i}{|t_j-u_j^i|}}{|H_i|*\varphi}$ 

  其中符号代表的意义是：a

  其中第$t$次第$i$个学生的可靠性为$r_i$ ,  $t_j$是教师为学生$j$作业打的真实分数，$u_j^i$是学生$i$给学生$j$打的分数，$\varphi$是最高分，

  $H_i$是评价者$i$打分的所有作业中被教师抽查的作业集。

- 如果本次没有被抽查到，沿用上次的可靠性，其可靠性将会在互评结束后更新：

  $r_i=1-\frac{\sum_{j\in H_i}{|t_j-u_j^i|}}{\varphi*l}$ 

  其中$t_j$是作业j在本次汇总后的最终分数



### 公式推导

即：

$\tau_v \sim N(\alpha, \beta)$  （PG8）或者$\sim \Gamma(\alpha, \beta)$（PG9） （$\alpha = r_i$）

$b_v \sim N(0, \frac{1}{\eta_0})$ 

$s_u \sim N(\alpha, \frac{1}{\gamma})$ 

$z_u^v \sim N(s_u+b_v, \frac{1}{\tau_v})$ 

$d^v_{ij} \sim N(s_i-s_j, \frac{2}{\tau_v})$ 

通过马尔可夫毯 *MB*(*x*)条件下可以下，*x*和其非马尔可夫毯变量条件独立，因此对于 *x* 而言，所有非马尔可夫毯变量都是冗余的，关于目标变量 *x* 的所有信息都包含在 *x* 的马尔可夫毯中。若需要了解目标变量的分布情况，仅需要了解其马尔可夫毯的信息即可，而不需要对于整个数据集进行了解。因此，对于各个隐含变量的后验分布的推断实际是在其马尔可夫毯条件下进行求解。

PG8模型中真实分数$s_i$的推断过程

由于某一被评者$s_i$提交的主观题作业的真实分数$t_i$没有闭式解（close-form solution），

因此采用近似离散推断策略在[0, 20]区间内以 0.1 为间隔求解隐含变量的近似后验分布。

$S_u \sim P(s_i|MB(s_i))$ 

$S \propto p(s_i| \mu_0, \gamma_0) \prod_{v \in S_i}P(z_i^v|s_i, b_v) \prod_{v \in G_{s_i}, u_j \in H_v}P(d^v_{ij}|s_i,s_j)$ 

$S \propto exp(-\frac{(s_i-u_0)^2\gamma_0}{2}) exp(\sum_{v\in G_i} (-\frac{(z_i^v-s_i-b_v)^2 \tau_v}{2}) exp(\sum_{v \in G_{s_i}} \sum_{u_j \in H_v} (-\frac{(d^v_{ij}-s_i+s_j)^2\tau_v}{4}))$ 

$exp(-\frac{(s_u-u_0)^2\gamma_0}{2}) = exp(-\frac{\gamma_0(s_u^2-2s_u\mu_0+\mu_0^2)}{2}) = exp(-\frac{\gamma_0 s_u^2-2s_u\mu_0\gamma_0)}{2}+const.)$ 

$exp(\sum_{v\in G_{s_i}} (-\frac{(z_i^v-s_i-b_v)^2 \tau_v}{2})=exp(\sum_{v\in G_{s_i}} (-\frac{\tau_v s_i^2-2(z^v_i-b_v)s_i\tau_v}{2})+const.)$ 

$exp(\sum_{v \in G_{s_i}} \sum_{j \in H_v} (-\frac{(d^v_{ij}-s_i+s_j)^2\tau_v}{4}) = exp(\sum_{v \in G_{s_i}} \sum_{j \in H_v}-\frac{\tau_vs_i^2-2(d_{ij}^v+s_j)s_i\tau_v}{4}+const.)$

$X = \gamma_0+\sum_{v\in G_{s_i}} \tau_v+\sum_{v \in G_{s_i}}\sum_{j \in H_v} \frac{\tau_v}{2} $ 

$Y = \gamma_0\mu_0 + \sum_{ v \in G_{s_i}}(z^v_i-b_v)\tau_v+\sum_{v \in G_{s_i}} \sum_{j \in H_v}\frac{(d^v_{ij}+s_j)\tau_v}{2}$ 

$s_i \sim N(\frac{Y}{X}, \frac{1}{X})$ 

---

$b_v\sim P(b_v|MB(b_v))$ 

$b \propto p(b_v|\eta_0) \prod_{h_i \in H_v} P(z_u^v|s_u, b_v)$  

$\propto exp(-\frac{b_v^2 \eta_0}{2}) exp(\sum_{h_i \in H_v} -\frac{(z_u^v-s_u-b_v)^2\tau_v}{2})$  

$\propto exp( - \frac{ (\eta_0+\sum_{h_i \in H_v}\tau_v)b_v^2-2\sum_{h_i \in H_v}(z_u^v-s_u)b_v\tau_v}{2} + const.)$  

$X = \eta_0 + \sum_{h_i \in H_v}\tau_v $  

$Y=\sum_{h_i \in H_v}\tau_v(z_u^v-s_u)$ 

$b \sim N(\frac{Y}{X}, \frac{1}{X})$ 

---

PG8：$\tau_v \sim N(\alpha, \beta)$ 

$\tau_v \sim P(\tau_v|MB(\tau_v))$ 

$\tau \propto P(\tau_v | \alpha, \beta) \prod_{h_i \in H_v} P(Z_u^v | s_u, b_v, \tau_v) \prod_{h_i,h_j \in H_v} P(d_{ij}^v) | s_i, s_j, \tau_v)$ 

$exp(-\frac{(\tau_v-\alpha)^2\beta}{2})$ 

$exp(-\frac{1}{2}\sum_{h_i \in H_v}\sqrt{\frac{\tau_i}{2\pi}}(Z_u^v-s_u-b_v)^2\tau_v) $  

$exp(-\frac{1}{4}\sum_{h_i,h_j \in H_v}\sqrt{\frac{\tau_i}{4\pi}}(d_{ij}^v-s_i+s_j)^2\tau_v)$ 

$\propto \tau_i^{\frac{|S_i|^2}{2}} exp(-\frac{\beta}{2}(\tau_v^2-\alpha^2-2\alpha\tau_v))$

$exp(-\sum_{h_i \in H_v}{\frac{\tau_v}{2}(z_i^v-(s_i+b_v)^2)}-\sum_{h_i,h_j \in H_v}\frac{\tau_v}{4}(d_{ij}^v-s_i+s_j)^2))$  

$\tau \propto \tau_i^{\frac{|S_i|^2}{2}} exp(-\frac{\beta}{2}(\tau_v-(\alpha+\sum_{h_i \in H_v}{\frac{(z_i^v-s_i-b_v)^2}{\beta}}+\sum_{h_i,h_j \in H_v} {\frac{(d^v_{ij}-s_i+s_j)^2}{2\beta}})))$ 

---

PG9：$\tau_v \sim G(\alpha, \beta)$ 

$\tau_v \sim P(\tau_v|MB(\tau_v))$ 

$\tau \propto P(\tau_v | \alpha, \beta) \prod_{h_i \in H_v} P(Z_u^v | s_u, b_v, \tau_v) \prod_{h_i,h_j \in H_v} P(d_{ij}^v) | s_i, s_j, \tau_v)$ 

$\propto \tau_v^\alpha exp(-\beta\tau_v-\sum_{h_i \in H_v}\sqrt\frac{\tau_v}{2\pi}\frac{\tau_v}{2}(Z_u^v-s_u-b_v)^2) $

$exp(-\sum_{h_i,h_j \in H_v}\sqrt\frac{\tau_v}{4\pi}\frac{\tau_v}{4}(d_{ij}^v-s_i+s_j)^2)$ 

$\propto \tau_v^{\alpha+\frac{|S_u|^2}{2}} exp(-\beta+\frac{1}{2}(\sum_{h_i \in H_v}(Z_u^v-s_u-b_v)^2+\sum_{h_i,h_j \in H_v}\frac{1}{2}(d_{ij}^v-s_i+s_j)^2))$

$\tau \sim \Gamma(\frac{|S_u|^2}{2}+\alpha, \beta+\frac{\sum_{h_i \in H_v}(Z_u^v-s_u-b_v)^2+\sum_{h_i,h_j \in H_v}\frac{1}{2}(d_{ij}^v-s_i+s_j)^2}{2})$ 

可靠性对于结果影响并不明显，如何将其变得明显，需要调整模型的参数大小

### 数据集

| 属性           | 数据库原理 | 数据结构 | 计算机网络 |
| -------------- | ---------- | -------- | ---------- |
| 作业次数       | 4          | 4        | 2          |
| 作业提交数     | 237        | 257      | 198        |
| 同行互评记录数 | 711        | 771      | 396        |
| 作业总分       | 10         | 10       | 10         |
